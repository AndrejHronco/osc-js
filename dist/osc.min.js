!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(this,function(){"use strict";function e(e){return Number(e)===e&&e%1===0}function t(e){return Number(e)===e&&e%1!==0}function r(e){return"string"==typeof e}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){return e instanceof Uint8Array}function i(e){return e+3&-4}function u(n){if(e(n))return"i";if(t(n))return"f";if(r(n))return"s";if(o(n))return"b";throw new Error("OSCMessage found unknown value type.")}function s(e){var t="";if(n(e))return"/"+e.join("/");if(r(e))return t=e,t.length>1&&"/"===t[t.length-1]&&(t=t.slice(0,t.length-1)),t.length>1&&"/"!==t[0]&&(t="/"+t),t;throw new Error("Helpers can only prepare addresses which are Array of String.")}var a=(function(){function e(e){this.value=e}function t(t){function r(e,t){return new Promise(function(r,o){var s={key:e,arg:t,resolve:r,reject:o,next:null};u?u=u.next=s:(i=u=s,n(e,t))})}function n(r,i){try{var u=t[r](i),s=u.value;s instanceof e?Promise.resolve(s.value).then(function(e){n("next",e)},function(e){n("throw",e)}):o(u.done?"return":"normal",u.value)}catch(e){o("throw",e)}}function o(e,t){switch(e){case"return":i.resolve({value:t,done:!0});break;case"throw":i.reject(t);break;default:i.resolve({value:t,done:!1})}i=i.next,i?n(i.key,i.arg):u=null}var i,u;this._invoke=r,"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(n)},l=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},h=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},p=function(){function e(){a(this,e),this.data=[],this.byteLength=0}return f(e,[{key:"add",value:function(e){var t=e.encode();return this.byteLength+=t.byteLength,this.data.push(t),this}},{key:"merge",value:function(){var e=new Uint8Array(this.byteLength),t=0;return this.data.forEach(function(r){e.set(r,t),t+=r.byteLength}),e}}]),e}(),d=function(){function e(t){a(this,e),this.value=t,this.offset=0}return f(e,[{key:"encode",value:function(e,t){var r=new Uint8Array(t),n=new DataView(r.buffer);if(!this.value)throw new Error("OSCAtomic can not be encoded with empty value.");return n[e](this.offset,this.value,!1),r}},{key:"decode",value:function(e,t,r,n){return this.value=e[t](n,!1),this.offset=n+r,this.offset}}]),e}(),y=function(t){function r(t){if(a(this,r),t&&!e(t))throw new Error("OSCAtomicInt32 constructor expects value of type integer number.");return h(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t))}return l(r,t),f(r,[{key:"encode",value:function(){return c(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"encode",this).call(this,"setInt32",4)}},{key:"decode",value:function(e,t){return c(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"decode",this).call(this,e,"getInt32",4,t)}}]),r}(d),v=function(e){function r(e){if(a(this,r),e&&!t(e))throw new Error("OSCAtomicFloat32 constructor expects value of type float number.");return h(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e))}return l(r,e),f(r,[{key:"encode",value:function(){return c(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"encode",this).call(this,"setFloat32",4)}},{key:"decode",value:function(e,t){return c(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"decode",this).call(this,e,"getFloat32",4,t)}}]),r}(d),w=function(e){function t(e){if(a(this,t),e&&"string"!=typeof e)throw new Error("OSCAtomicString constructor expects value of type string.");return h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),f(t,[{key:"encode",value:function(){if(!this.value)throw new Error("OSCAtomicString can not be encoded with empty value.");for(var e=this.value+"\0",t=i(e.length),r=new Uint8Array(t),n=0;n<e.length;n+=1)r[n]=e.charCodeAt(n);return r}},{key:"decode",value:function(e,t){for(var r=t,n=void 0,o=[];r<e.byteLength;r+=1){if(n=e.getUint8(r),0===n){r+=1;break}o.push(n)}if(r===e.length)throw new Error("OSCAtomicString found a malformed OSC string.");return this.offset=i(r),this.value=String.fromCharCode.apply(null,o),this.offset}}]),t}(d),g=function(e){function t(e){if(a(this,t),e&&!o(e))throw new Error("OSCAtomicBlob constructor expects value of type Uint8Array.");return h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),f(t,[{key:"encode",value:function(){if(!this.value)throw new Error("OSCAtomicBlob can not be encoded with empty value.");var e=i(this.value.byteLength),t=new Uint8Array(e+4),r=new DataView(t.buffer);return r.setInt32(0,this.value.byteLength,!1),t.set(this.value,4),t}},{key:"decode",value:function(e,t){var r=e.getInt32(t,!1);return this.value=new Uint8Array(e.buffer,t+4,r),this.offset=i(t+4+r),this.offset}}]),t}(d),b=function(){function i(){a(this,i),this.address="",this.types="",this.args=[],this.timetag=0;for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];if(t.length>0){if(!r(t[0])&&!n(t[0]))throw new Error("OSCMessage constructor first argument (address) must be a string or array.");this.address=s(t.shift()),this.types=t.map(function(e){return u(e)}).join(""),this.args=t}}return f(i,[{key:"add",value:function(e){if(!e)throw new Error("OSCMessage expects a valid value for adding.");this.args.push(e),this.types+=u(e)}},{key:"encode",value:function(){var n=this;if(0===this.address.length||"/"!==this.address[0])throw new Error("OSCMessage does not have a proper address.");var i=new p;return i.add(new w(this.address)),i.add(new w(","+this.types)),this.args.length>0&&!function(){var u=void 0;n.args.forEach(function(n){if(e(n))u=new y(n);else if(t(n))u=new v(n);else if(r(n))u=new w(n);else{if(!o(n))throw new Error("OSCMessage found unknown argument type.");u=new g(n)}i.add(u)})}(),i.merge()}},{key:"decode",value:function(e){var t=new w;t.decode(e,0);var r=new w;if(r.decode(e,t.offset),0===t.value.length||"/"!==t.value[0])throw new Error("OSCMessage found malformed or missing OSC address string.");if(0===r.value.length&&","!==r.value[0])throw new Error("OSCMessage found malformed or missing OSC type string.");for(var n=r.offset,o=void 0,i=void 0,u=[],s=1;s<r.value.length;s+=1){if(i=r.value[s],"i"===i)o=new y;else if("f"===i)o=new v;else if("s"===i)o=new w;else{if("b"!==i)throw new Error("OSCMessage found non-standard argument type.");o=new g}n=o.decode(e,n),u.push(o.value)}return this.address=t.value,this.types=r.value,this.args=u,this}}]),i}();module.exports.OSCMessage=b});
//# sourceMappingURL=osc.min.js.map