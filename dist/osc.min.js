!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.OSC=e.OSC||{})}(this,function(e){"use strict";function t(e){return Number(e)===e&&e%1===0}function n(e){return Number(e)===e&&e%1!==0}function r(e){return"string"==typeof e}function o(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e){return e instanceof Uint8Array}function u(e){return e+3&-4}function s(e){if(t(e))return"i";if(n(e))return"f";if(r(e))return"s";if(i(e))return"b";throw new Error("OSC Message found unknown value type.")}function a(e){var t="";if(o(e))return"/"+e.join("/");if(r(e))return t=e,t.length>1&&"/"===t[t.length-1]&&(t=t.slice(0,t.length-1)),t.length>1&&"/"!==t[0]&&(t="/"+t),t;throw new Error("OSC Helpers can only prepare addresses which are Array of String.")}var f=(function(){function e(e){this.value=e}function t(t){function n(e,t){return new Promise(function(n,o){var s={key:e,arg:t,resolve:n,reject:o,next:null};u?u=u.next=s:(i=u=s,r(e,t))})}function r(n,i){try{var u=t[n](i),s=u.value;s instanceof e?Promise.resolve(s.value).then(function(e){r("next",e)},function(e){r("throw",e)}):o(u.done?"return":"normal",u.value)}catch(e){o("throw",e)}}function o(e,t){switch(e){case"return":i.resolve({value:t,done:!0});break;case"throw":i.reject(t);break;default:i.resolve({value:t,done:!1})}i=i.next,i?r(i.key,i.arg):u=null}var i,u;this._invoke=n,"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},l=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},d=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},v=function e(t){f(this,e),this.value=t,this.offset=0},p=function(){function e(){f(this,e),this.data=[],this.byteLength=0}return c(e,[{key:"add",value:function(e){var t=e.encode();return this.byteLength+=t.byteLength,this.data.push(t),this}},{key:"merge",value:function(){var e=new Uint8Array(this.byteLength),t=0;return this.data.forEach(function(n){e.set(n,t),t+=n.byteLength}),e}}]),e}(),y=function(e){function t(){return f(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),c(t,[{key:"encode",value:function(e,t){var n=new Uint8Array(t),r=new DataView(n.buffer);if(!this.value)throw new Error("OSC Atomic can not be encoded with empty value.");return r[e](this.offset,this.value,!1),n}},{key:"decode",value:function(e,t,n,r){return this.value=e[t](r,!1),this.offset=r+n,this.offset}}]),t}(v),w=function(e){function n(e){if(f(this,n),e&&!t(e))throw new Error("OSC AtomicInt32 constructor expects value of type integer number.");return d(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return l(n,e),c(n,[{key:"encode",value:function(){return h(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"encode",this).call(this,"setInt32",4)}},{key:"decode",value:function(e,t){return h(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"decode",this).call(this,e,"getInt32",4,t)}}]),n}(y),g=function(e){function t(e){if(f(this,t),e&&!n(e))throw new Error("OSC AtomicFloat32 constructor expects value of type float number.");return d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),c(t,[{key:"encode",value:function(){return h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"encode",this).call(this,"setFloat32",4)}},{key:"decode",value:function(e,n){return h(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"decode",this).call(this,e,"getFloat32",4,n)}}]),t}(y),b=function(e){function t(e){if(f(this,t),e&&"string"!=typeof e)throw new Error("OSC AtomicString constructor expects value of type string.");return d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),c(t,[{key:"encode",value:function(){if(!this.value)throw new Error("OSC AtomicString can not be encoded with empty value.");for(var e=this.value+"\0",t=u(e.length),n=new Uint8Array(t),r=0;r<e.length;r+=1)n[r]=e.charCodeAt(r);return n}},{key:"decode",value:function(e,t){for(var n=t,r=void 0,o=[];n<e.byteLength;n+=1){if(r=e.getUint8(n),0===r){n+=1;break}o.push(r)}if(n===e.length)throw new Error("OSC AtomicString found a malformed  string.");return this.offset=u(n),this.value=String.fromCharCode.apply(null,o),this.offset}}]),t}(y),m=function(e){function t(e){if(f(this,t),e&&!i(e))throw new Error("OSC AtomicBlob constructor expects value of type Uint8Array.");return d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),c(t,[{key:"encode",value:function(){if(!this.value)throw new Error("OSC AtomicBlob can not be encoded with empty value.");var e=u(this.value.byteLength),t=new Uint8Array(e+4),n=new DataView(t.buffer);return n.setInt32(0,this.value.byteLength,!1),t.set(this.value,4),t}},{key:"decode",value:function(e,t){var n=e.getInt32(t,!1);return this.value=new Uint8Array(e.buffer,t+4,n),this.offset=u(t+4+n),this.offset}}]),t}(y),O=function(){function e(){f(this,e),this.offset=0,this.address="",this.types="",this.args=[],this.timetag=0;for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];if(n.length>0){if(!r(n[0])&&!o(n[0]))throw new Error("OSC Message constructor first argument (address) must be a string or array.");this.address=a(n.shift()),this.types=n.map(function(e){return s(e)}).join(""),this.args=n}}return c(e,[{key:"add",value:function(e){if(!e)throw new Error("OSC Message expects a valid value for adding.");this.args.push(e),this.types+=s(e)}},{key:"encode",value:function(){var e=this;if(0===this.address.length||"/"!==this.address[0])throw new Error("OSC Message does not have a proper address.");var o=new p;return o.add(new b(this.address)),o.add(new b(","+this.types)),this.args.length>0&&!function(){var u=void 0;e.args.forEach(function(e){if(t(e))u=new w(e);else if(n(e))u=new g(e);else if(r(e))u=new b(e);else{if(!i(e))throw new Error("OSC Message found unknown argument type.");u=new m(e)}o.add(u)})}(),this.offset=o.byteLength,o.merge()}},{key:"decode",value:function(e){var t=new b;t.decode(e,0);var n=new b;if(n.decode(e,t.offset),0===t.value.length||"/"!==t.value[0])throw new Error("OSC Message found malformed or missing address string.");if(0===n.value.length&&","!==n.value[0])throw new Error("OSC Message found malformed or missing type string.");for(var r=n.offset,o=void 0,i=void 0,u=[],s=1;s<n.value.length;s+=1){if(i=n.value[s],"i"===i)o=new w;else if("f"===i)o=new g;else if("s"===i)o=new b;else{if("b"!==i)throw new Error("OSC Message found non-standard argument type.");o=new m}r=o.decode(e,r),u.push(o.value)}return this.address=t.value,this.types=n.value,this.args=u,this}}]),e}(),_=2208988800,k=4294967296,S=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(f(this,e),!t(n)||!t(r))throw new Error("OSC Timetag constructor expects values of type integer number.");this.seconds=n,this.fractions=r}return c(e,[{key:"timestamp",value:function(e){var t=void 0;if("number"==typeof e){t=e/1e3;var n=Math.floor(t);return this.seconds=n+_,this.fractions=Math.round(k*(t-n)),e}return t=this.seconds-_,1e3*(t+this.fractions/k)}}]),e}(),E=function(e){function t(e){if(f(this,t),e&&!(e instanceof S))throw new Error("OSC AtomicTimetag constructor expects value of type Timetag.");return d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),c(t,[{key:"encode",value:function(){if(!this.value)throw new Error("OSC AtomicTimetag can not be encoded with empty value.");var e=this.value,t=e.seconds,n=e.fractions,r=new Uint8Array(8),o=new DataView(r.buffer);return o.setInt32(0,t,!1),o.setInt32(4,n,!1),r}},{key:"decode",value:function(e,t){var n=e.getUint32(t,!1),r=e.getUint32(t+4,!1);return this.value=new S(n,r),this.offset+=8,this.offset}}]),t}(y),C="#bundle",A=function(){function e(){var t=this;f(this,e),this.offset=0,this.timetag=new E,this.bundleElements=[];for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];r.length>0&&(r[0]instanceof E?this.timetag=r.shift():r.forEach(function(e){t.add(e)}))}return c(e,[{key:"add",value:function(t){if(!(t instanceof O||t instanceof e))throw new Error("OSC Bundle contains only Messages and Bundles");this.bundleElements.push(t)}},{key:"encode",value:function(){var e=new p;return e.add(new b(C)),e.add(this.timetag),this.bundleElements.forEach(function(t){t.encode(),e.add(new w(t.offset)),e.add(t)}),e.merge()}},{key:"decode",value:function(e,t){var n=new b,r=n.decode(e,t);if(n!==C)throw new Error("OSC Bundle does not contain a valid #bundle head.");var o=new E;r=o.decode(e,r),this.bundleElements=[];for(var i=0;i<e.byteLength;i+=1){var u=new j,s=new w;r=s.decode(e,r),u.decode(e,r),this.bundleElements.push(u)}return this.offset=r,this.timetag=o,r}}]),e}(),j=function(e){function t(e){if(f(this,t),e&&!(e instanceof O||e instanceof A))throw new Error("OSC Packet can only consist of Message or Bundle.");return d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),c(t,[{key:"encode",value:function(){if(!this.value)throw new Error("OSC Packet cant be encoded with empty body.");return this.value.encode()}},{key:"decode",value:function(e,t){if(e.byteLength%4!==0)throw new Error("OSC Packet byteLength has to be a multiple of four.");var n=new b;n.decode(e,0);var r=void 0;return n.value===C?r=new A:(r=new O,t&&(r.timetag=t)),r.decode(e),r}}]),t}(v);e.Packet=j,e.Bundle=A,e.Message=O,e.AtomicInt32=w,e.AtomicFloat32=g,e.AtomicString=b,e.AtomicBlob=m,e.AtomicTimetag=E,e.Timetag=S,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=osc.min.js.map