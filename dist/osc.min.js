!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.OSC=t.OSC||{})}(this,function(t){"use strict";function e(t){return Number(t)===t&&t%1===0}function n(t){return Number(t)===t&&t%1!==0}function r(t){return"string"==typeof t}function o(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t){return t instanceof Uint8Array}function a(t){return t+3&-4}function u(t){if(e(t))return"i";if(n(t))return"f";if(r(t))return"s";if(i(t))return"b";throw new Error("OSC Message found unknown value type.")}function s(t){var e="";if(o(t))return"/"+t.join("/");if(r(t))return e=t,e.length>1&&"/"===e[e.length-1]&&(e=e.slice(0,e.length-1)),e.length>1&&"/"!==e[0]&&(e="/"+e),e;throw new Error("OSC Helpers can only prepare addresses which are Array of String.")}var f=(function(){function t(t){this.value=t}function e(e){function n(t,e){return new Promise(function(n,o){var u={key:t,arg:e,resolve:n,reject:o,next:null};a?a=a.next=u:(i=a=u,r(t,e))})}function r(n,i){try{var a=e[n](i),u=a.value;u instanceof t?Promise.resolve(u.value).then(function(t){r("next",t)},function(t){r("throw",t)}):o(a.done?"return":"normal",a.value)}catch(t){o("throw",t)}}function o(t,e){switch(t){case"return":i.resolve({value:e,done:!0});break;case"throw":i.reject(e);break;default:i.resolve({value:e,done:!1})}i=i.next,i?r(i.key,i.arg):a=null}var i,a;this._invoke=n,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),h=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},p=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},v=function t(e){f(this,t),this.value=e,this.offset=0},y=function(){function t(){f(this,t),this.data=[],this.byteLength=0}return c(t,[{key:"add",value:function(t){var e=t.pack();return this.byteLength+=e.byteLength,this.data.push(e),this}},{key:"merge",value:function(){var t=new Uint8Array(this.byteLength),e=0;return this.data.forEach(function(n){t.set(n,e),e+=n.byteLength}),t}}]),t}(),d=function(t){function e(){return f(this,e),p(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return l(e,t),c(e,[{key:"pack",value:function(t,e){var n=new Uint8Array(e),r=new DataView(n.buffer);if(!this.value)throw new Error("OSC Atomic can not be encoded with empty value.");return r[t](this.offset,this.value,!1),n}},{key:"unpack",value:function(t,e,n,r){return this.value=t[e](r,!1),this.offset=r+n,this.offset}}]),e}(v),w=function(t){function n(t){if(f(this,n),t&&!e(t))throw new Error("OSC AtomicInt32 constructor expects value of type integer number.");return p(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t))}return l(n,t),c(n,[{key:"pack",value:function(){return h(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"pack",this).call(this,"setInt32",4)}},{key:"unpack",value:function(t,e){return h(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"unpack",this).call(this,t,"getInt32",4,e)}}]),n}(d),g=function(t){function e(t){if(f(this,e),t&&!n(t))throw new Error("OSC AtomicFloat32 constructor expects value of type float number.");return p(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return l(e,t),c(e,[{key:"pack",value:function(){return h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"pack",this).call(this,"setFloat32",4)}},{key:"unpack",value:function(t,n){return h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"unpack",this).call(this,t,"getFloat32",4,n)}}]),e}(d),b=function(t){function e(t){if(f(this,e),t&&"string"!=typeof t)throw new Error("OSC AtomicString constructor expects value of type string.");return p(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return l(e,t),c(e,[{key:"pack",value:function(){if(!this.value)throw new Error("OSC AtomicString can not be encoded with empty value.");for(var t=this.value+"\0",e=a(t.length),n=new Uint8Array(e),r=0;r<t.length;r+=1)n[r]=t.charCodeAt(r);return n}},{key:"unpack",value:function(t,e){for(var n=e,r=void 0,o=[];n<t.byteLength;n+=1){if(r=t.getUint8(n),0===r){n+=1;break}o.push(r)}if(n===t.length)throw new Error("OSC AtomicString found a malformed OSC string.");return this.offset=a(n),this.value=String.fromCharCode.apply(null,o),this.offset}}]),e}(d),m=function(t){function e(t){if(f(this,e),t&&!i(t))throw new Error("OSC AtomicBlob constructor expects value of type Uint8Array.");return p(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return l(e,t),c(e,[{key:"pack",value:function(){if(!this.value)throw new Error("OSC AtomicBlob can not be encoded with empty value.");var t=a(this.value.byteLength),e=new Uint8Array(t+4),n=new DataView(e.buffer);return n.setInt32(0,this.value.byteLength,!1),e.set(this.value,4),e}},{key:"unpack",value:function(t,e){var n=t.getInt32(e,!1);return this.value=new Uint8Array(t.buffer,e+4,n),this.offset=a(e+4+n),this.offset}}]),e}(d),k=function(){function t(){f(this,t),this.offset=0,this.address="",this.types="",this.args=[],this.timetag=0;for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];if(n.length>0){if(!r(n[0])&&!o(n[0]))throw new Error("OSC Message constructor first argument (address) must be a string or array.");this.address=s(n.shift()),this.types=n.map(function(t){return u(t)}).join(""),this.args=n}}return c(t,[{key:"add",value:function(t){if(!t)throw new Error("OSC Message expects a valid value for adding.");this.args.push(t),this.types+=u(t)}},{key:"pack",value:function(){var t=this;if(0===this.address.length||"/"!==this.address[0])throw new Error("OSC Message does not have a proper address.");var o=new y;return o.add(new b(this.address)),o.add(new b(","+this.types)),this.args.length>0&&!function(){var a=void 0;t.args.forEach(function(t){if(e(t))a=new w(t);else if(n(t))a=new g(t);else if(r(t))a=new b(t);else{if(!i(t))throw new Error("OSC Message found unknown argument type.");a=new m(t)}o.add(a)})}(),this.offset=o.byteLength,o.merge()}},{key:"unpack",value:function(t){var e=new b;e.unpack(t,0);var n=new b;if(n.unpack(t,e.offset),0===e.value.length||"/"!==e.value[0])throw new Error("OSC Message found malformed or missing address string.");if(0===n.value.length&&","!==n.value[0])throw new Error("OSC Message found malformed or missing type string.");for(var r=n.offset,o=void 0,i=void 0,a=[],u=1;u<n.value.length;u+=1){if(i=n.value[u],"i"===i)o=new w;else if("f"===i)o=new g;else if("s"===i)o=new b;else{if("b"!==i)throw new Error("OSC Message found non-standard argument type.");o=new m}r=o.unpack(t,r),a.push(o.value)}return this.address=e.value,this.types=n.value,this.args=a,this}}]),t}(),O=2208988800,_=4294967296,S=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(f(this,t),!e(n)||!e(r))throw new Error("OSC Timetag constructor expects values of type integer number.");this.seconds=n,this.fractions=r}return c(t,[{key:"timestamp",value:function(t){var e=void 0;if("number"==typeof t){e=t/1e3;var n=Math.floor(e);return this.seconds=n+O,this.fractions=Math.round(_*(e-n)),t}return e=this.seconds-O,1e3*(e+this.fractions/_)}}]),t}(),E=function(t){function e(t){if(f(this,e),t&&!(t instanceof S))throw new Error("OSC AtomicTimetag constructor expects value of type Timetag.");return p(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return l(e,t),c(e,[{key:"pack",value:function(){if(!this.value)throw new Error("OSC AtomicTimetag can not be encoded with empty value.");var t=this.value,e=t.seconds,n=t.fractions,r=new Uint8Array(8),o=new DataView(r.buffer);return o.setInt32(0,e,!1),o.setInt32(4,n,!1),r}},{key:"unpack",value:function(t,e){var n=t.getUint32(e,!1),r=t.getUint32(e+4,!1);return this.value=new S(n,r),this.offset+=8,this.offset}}]),e}(d),C="#bundle",A=function(){function t(){var e=this;f(this,t),this.offset=0,this.timetag=new E,this.bundleElements=[];for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];r.length>0&&(r[0]instanceof E?this.timetag=r.shift():r.forEach(function(t){e.add(t)}))}return c(t,[{key:"add",value:function(e){if(!(e instanceof k||e instanceof t))throw new Error("OSC Bundle contains only Messages and Bundles");this.bundleElements.push(e)}},{key:"pack",value:function(){var t=new y;return t.add(new b(C)),t.add(this.timetag),this.bundleElements.forEach(function(e){e.pack(),t.add(new w(e.offset)),t.add(e)}),t.merge()}},{key:"unpack",value:function(t,e){var n=new b,r=n.unpack(t,e);if(n!==C)throw new Error("OSC Bundle does not contain a valid #bundle head.");var o=new E;r=o.unpack(t,r),this.bundleElements=[];for(var i=0;i<t.byteLength;i+=1){var a=new j,u=new w;r=u.unpack(t,r),a.unpack(t,r),this.bundleElements.push(a)}return this.offset=r,this.timetag=o,r}}]),t}(),j=function(t){function e(t){if(f(this,e),t&&!(t instanceof k||t instanceof A))throw new Error("OSC Packet can only consist of Message or Bundle.");return p(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return l(e,t),c(e,[{key:"pack",value:function(){if(!this.value)throw new Error("OSC Packet cant be encoded with empty body.");return this.value.pack()}},{key:"unpack",value:function(t,e){if(t.byteLength%4!==0)throw new Error("OSC Packet byteLength has to be a multiple of four.");var n=new b;n.unpack(t,0);var r=void 0;return n.value===C?r=new A:(r=new k,e&&(r.timetag=e)),r.unpack(t),r}}]),e}(v);t.Packet=j,t.Bundle=A,t.Message=k,t.AtomicInt32=w,t.AtomicFloat32=g,t.AtomicString=b,t.AtomicBlob=m,t.AtomicTimetag=E,t.Timetag=S,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=osc.min.js.map